<!DOCTYPE html>
<html>
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet"/>

  <title>WHB Configurator</title>

  <script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

</head>
<body>
<main class="container" role="main">
  <a class="text-muted float-right" href="raw-editor.htm">JSON Text Editor</a>
  <h1 class="mt-5">WHB Configurator</h1>
  <hr/>

  <div class='column col-md-12' id='editor_holder'></div>

  <button class="btn btn-block btn-success mt-2" id="btn-save">Save</button>

</main>

<script>
  // Initialize the editor
  var editor = new JSONEditor(document.getElementById('editor_holder'), {
    ajax: true,
    theme: 'bootstrap4',
    iconlib: 'fontawesome5',
    disable_collapse: true,
    disable_edit_json: false,
    disable_properties: true,
    prompt_before_delete: false,
    disable_array_reorder: true,
    disable_array_delete_last_row: true,

    // The schema for the editor
    schema: {
      $ref: "schema.json",
    },
  });

  $('#btn-save').on('click', function () {
    // Get the value from the editor
    $.ajax({
      method: "put",
      url: "/config.json",
      data: JSON.stringify(editor.getValue(), null, 2),
      success(data) {
        $('#json').val(JSON.stringify(data, null, 2));
      }
    });
  });

  $().ready(function () {
    $.ajax({
      url: 'config.json',
      success: function (json) {
        editor.setValue(json);
      }
    })
  });
</script>
</body>
</html>
